template:
  name: create objects non prod
  type: Step
  projectIdentifier: Snowflake
  orgIdentifier: default
  spec:
    type: ShellScript
    spec:
      shell: Bash
      executionTarget: {}
      source:
        type: Inline
        spec:
          script: |-
            echo -e "[connections.connection]\naccountname = <+pipeline.variables.account_name>\nusername = <+pipeline.variables.username>\npassword = <+secrets.getValue('account.snowflake_password')>" > ~/.snowsql/config
            
            echo "Executing SQL queries"
            cat <+pipeline.stages.Create_non_prod_env.spec.execution.steps.Fetch_Queries.output.outputVariables.create_object_sql>
            
            snowsql -c connection -f <+pipeline.stages.Create_non_prod_env.spec.execution.steps.Fetch_Queries.output.outputVariables.create_object_sql>
      environmentVariables: []
      outputVariables: []
      delegateSelectors: []
    timeout: 10m
  identifier: create_objects_non_prod
  versionLabel: v1
